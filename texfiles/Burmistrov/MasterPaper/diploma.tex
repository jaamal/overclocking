\documentclass[a4paper,14pt]{extarticle}
\usepackage{extsizes}
\usepackage[cp1251]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{indentfirst}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{graphicx}

%\usepackage{rusnotation}
\usepackage{srcltx}

\usepackage[left=3cm, right=2cm, top=20mm, bottom=25mm]{geometry}
\pagestyle{plain}
\baselineskip=1.5\baselineskip

\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\newcommand{\R}{\mathbb{R}}
\newcommand{\aB}{\hat{a}_B}
\newcommand{\strset}{\texttt{set}}
\newcommand{\rootset}{\texttt{rooted\_set}}

\newtheorem{teo}{Теорема}
\newtheorem{pro}{Предложение}
\newtheorem{lem}{Лемма}
\newtheorem{cons}{Следствие}
%\newtheorem{algo}{Алгоритм}
%\newtheorem*{exa}{Пример}

\theoremstyle{definition}
\newtheorem{algo}{Алгоритм}
\newtheorem*{exa}{Пример}

\tolerance=1000

\begin{document}
\thispagestyle{empty}
\begin{center}
{\small Министерство образования и науки Российской федерации}\\
{\scriptsize Федеральное государственное автономное образовательное учреждение высшего профессионального образования}\\
<<Уральский федеральный университет\\ имени первого Президента России Б.\,Н.\,Ельцина>>\\\vspace{1cm}
Математико-механический факультет\\\vspace{1cm} 
Кафедра алгебры и дискретной математики\\\vspace{3.8cm}
О применении метода факторизации для решения задачи о минимизации 
облучения персонала\\
\vspace{2.9cm}
\hspace{-1cm}
\begin{minipage}{70mm}
 \noindent
\begin{center}
 <<Допущен к защите>>\\ \vspace{3pt}\rule{45mm}{0.3pt}\\ 
 <<\rule{12pt}{0.3pt}>> \rule{20mm}{0.3pt} 2011\,г.
\end{center}
\end{minipage}
\begin{minipage}{85mm}
\begin{flushleft}
{\small Квалификационная работа на степень\\ магистра математики по направлению\\ 
<<Математика, прикладная математика>>\\ студента группы МГМТ-2\\
\vspace{1mm}
Айзенштейна Даниила Олеговича\\
\vspace{1cm}
Научный руководитель Прохорова~М.\,Ф.\\
к.\,ф.-м.\,н., с.\,н.\,с. ИММ УрО РАН}
\end{flushleft}

\end{minipage}
\vspace{5.7cm}

\noindentЕкатеринбург\\
2011
\end{center}

\pagebreak
\tableofcontents
\pagebreak

\sloppy
\section*{Введение.}
\addcontentsline{toc}{section}{Введение}
В работе \cite{tasc_desc} рассматривается задача оптимизации 
последовательности демонтажа элементов энергоблока АЭС с целью минимизации 
суммарной дозы облучения персонала. 

Пусть $H_i$~--- мощность дозы излучения, создаваемая $i$-м элементом, 
$t_i$~--- время демонтажа $i$-го элемента, а $\alpha \in S_n$~--- 
последовательность демонтажа (упорядочение). Тогда можно определить 
величину $F_i$~--- время окончания демонтажа $i$-го элемента по формуле
$$F_i = \hspace*{-3mm}\sum_{\alpha(j) \leq \alpha(i)}\hspace*{-3mm}t_j$$.
Соответственно, суммарная доза облучения будет равна 
$$G(\alpha) = \sum_{i=1}^nH_iF_i.$$

В практических задачах различные технологические ограничения зачастую 
могут запрещать демонтировать один элементы раньше, чем будет  
демонтирован другой элемент.

Условиями предшествования будем называть набор пар (отношение) $E~=~\{(a_k,b_k)\}$, 
означающий, что в допустимой последовательности демонтажа элемент с номером 
$a_k$ должен быть демонтирован раньше элемента с номером $b_k$.

Очевидно, такая задача имеет решение тогда и только тогда, когда условия 
предшествования задают некоторый частичный порядок на множестве 
$\overline{1,n}$. Поэтому, не ограничивая общность, можно считать 
набор пар $E$ отношением порядка.

Таким образом задача минимизации суммарной дозы облучения может быть 
сформулирована как задача минимизации функционала $G(\alpha)$ для 
упорядочений $\alpha$, удовлетворяющих условиям предшествования.

Настоящее исследование посвящено решению задачи о минимизации такого 
функционала. Результатом исследования стало доказательство нескольких 
теорем, позволяющих сформулировать алгоритмы для решения этой задачи.

В Главе 1 формулируются основные определения, используемые в дальнейшем.

В Главе 2 формулируются и доказываются ряд вспомогательных утверждений, а 
в конце главы находится доказательство основной теоремы, позволяющей 
построить алгоритмы решения поставленной задачи.

В главе 3 построены два алгоритма. Первый их них применим для графов 
специального вида и позволяет получить для них решение, имея при этом 
малую временную сложность. Второй алгоритм применим для графов 
произвольной структуры, но позволяет лишь уменьшить размерность задачи.

Основные результаты работы были представлены на 42-й Всероссийской 
молодёжной конференции <<Современные проблемы математики>> (Екатеринбург, 
2011).

Также в ходе исследования были изучены другие подходы к решению 
вышеописанной задачи. Результаты этих исследований были опубликованы в 
сборнике тезисов 42-й Всероссийской молодёжной конференции <<Современные 
проблемы математики>> (Екатеринбург, 2011) \cite{Thesis}.

\pagebreak
\section{Основные определения.}
В теоретических построениях удобнее бывает не привязываться к 
фиксированной нумерации энергоблоков. Поэтому
переформулируем задачу в более общем виде. Пусть $A = \{a_1,\dots 
a_n\}$~--- некоторое \emph{множество работ}. Будем называть \emph{упорядочением} 
$A$ взаимно-однозначное отображение $\alpha: A \rightarrow 
\{1,\dots,n\}$. Рассмотрим также две функции $H: A \rightarrow \R$ и 
$t: A \rightarrow \R_+$~--- мощности излучения и продолжительности 
демонтажа соответственно. 

Аналогично исходной постановке определим функции 
времени окончания демонтажа $F_\alpha: A \rightarrow \R_+$:
$$F_\alpha(a) = \hspace*{-4mm}\sum_{\substack{b \in A\\ \alpha(b) \leq 
\alpha(a)}}\hspace*{-4mm}t(b)$$
и суммарной дозы облучения $G: \{1,\dots,n\}^A \rightarrow \R$:
$$G(\alpha) = \sum_{a \in A}H(a)F_\alpha(a)$$

Совокупность из множества $A$, отношения $E$ на нём, функций $H$ и $t$ будем 
называть \emph{размещением} со множеством работ $A$, условиями 
предшествования $E$, функцией мощности $H$ и функцией продолжительности 
$t$.

В рассматриваемой задаче интерес представляют только лишь те упорядочения 
$A$, которые удовлетворяют условиям предшествования $E$. Такие 
упорядочения будем называть \emph{упорядочениями} размещения $Q$ со множеством работ 
$A$ и условиями предшествования $E$. Искомое упорядочение размещения $Q$, 
дающее минимум функционала $G$, будем называть \emph{оптимальным}.

Ограничив задачу рассмотрением некоторого подмножества $B$ множества работ 
$A$, получим \emph{подразмещение}, порождённое множеством $B$. Более 
формально, подразмещение $Q|_B$ размещения $Q=(A, E, H, t)$~--- это 
размещение $(B, E|_B, H|_B, t|_B)$.

Для того, чтобы рассматривать подразмещение как отдельный независимый 
объект, понадобится дополнительное свойство: все работы этого 
подразмещения выполняются подряд в некотором оптимальном упорядочении 
исходного размещения. Подразмещения с таким свойством будем называть 
\emph{идеальными}.

Более формально это можно записать 
следующим образом: если $\alpha$~--- некоторое оптимальное упорядочение 
$Q$, то прообраз любого множества вида $[i,j]$, где $i, j\in 
\overline{1,n}$ будет образовывать идеальное подразмещение. 

Также введём понятние \emph{факторразмещения}. Для этого в размещении 
$Q~=~(A,E,H,t)$ заменим идеальное подразмещение $Q|_B$ на фиктивную работу 
$\aB$. Получим подразмещение $Q/B~=~(A/B, E', H', t')$, где 
\begin{itemize}
	\item$A/B=A\setminus B \cup \{\aB\}$;
	\item$E' = E|_{A\setminus B} \cup \{(a,\aB) | a\in prev_E(B,A)\} \cup 
		\{(\aB,a) | a\in next_E(B,A)\}$;
	\item$H'|_{A\setminus B} = H|_{A\setminus B}$, $H'(\aB) = 
		\sum\limits_{b\in B}H(b)$;
	\item$t'|_{A\setminus B} = t|_{A\setminus B}$, $t'(\aB) = 
		\sum\limits_{b\in B}t(b)$.
\end{itemize}
Здесь $prev_E(B,A)=\{a\in A\setminus B | \exists b\in B:(a,b)\in E\}$, 
$next_E(B,A)=\{a\in A\setminus B | \exists b\in B:(b,a)\in E\}$.

Таким образом, в факторразмещении $Q/B$ множество $B$ как бы 
<<схлапывается>> в один элемент, эквивалентный с точки зрения функций 
мощности и времени и отношения предшествования.

То, что в результате действительно получится размещение показывает 
следующее
\begin{pro}
Определение факторразмещения корректно.
\end{pro}
\begin{proof}
Для доказательства корректности достаточно показать, что условия 
предшествования факторразмещения образуют частичный порядок. 
Предположим противное: пусть имеется набор работ $a_0,~a_1,~\dots,~a_k~\in~A/B$, $k > 0$, 
такой что $\forall i=\overline{1,k}\ (a_{i-1},a_i)\in E'$, $(a_k, a_0)\in E'$. 
Заметим, что $\aB\in \{a_0, \dots a_k\}$, иначе мы получим противоречие с 
тем, что $Q$ является размещением. Перенумерацией работ можно 
добиться, чтобы $a_0 = \aB$; кроме того, можно считать, что $\forall i~>~0\ a_i~\in~A$. 
Тогда $\exists b_0, b_1 \in B: (b_0, a_1) \in E$, $(a_k, b_1)\in E$, $\forall i~=~\overline{2,k}\ 
(a_{i-1},a_i)\in E$. Но тогда из определения идеального подразмещения 
следует, что и все $a_i$ также будут элементами $B$, что противоречит 
предположению о том, что $a_i \in A/B$.
\end{proof}

В результате перехода к факторразмещению задача распадается на две 
подзадачи, которые можно решать по отдельности. Вполне естественным 
представлется затем <<объединить>> эти два решения.

Пусть $Q|_B$~--- идеальное подразмещение $Q=(A,E,H,t)$. Пусть также $\beta$~--- 
упорядочение $Q|_B$, а $\gamma$~--- упорядочение $Q/B$. Упорядочением 
множества $A$, \emph{порождённым} упорядочениями $\beta$ и $\gamma$, 
будем называть упорядочение $\alpha$, удовлетворяющее следующим условиям:
\begin{itemize}
	\item$\forall a\in A\setminus B, \gamma(a) < \gamma(\aB) \Rightarrow
		\alpha(a)=\gamma(a)$
	\item$\forall a\in A\setminus B, \gamma(a) > \gamma(\aB) \Rightarrow
		\alpha(a)=\gamma(a) + |B| - 1$
	\item$\forall b\in B\ \alpha(b) = \beta(b) + \gamma(\aB) - 1$.
\end{itemize}

Следующее предложение обосновывает возможность вышеуказанного <<объединения>> 
упорядочений подразмещения и факторразмещения.
\begin{pro}\label{inducedCor}
Пусть $Q|_B$~--- идеальное подразмещение $Q=(A,E,H,t)$. Тогда упорядочение 
множества $A$, порождённое упорядочениями $Q|_B$ и $Q/B$, будет также и 
упорядочением $Q$. Более того, в обозначениях определений факторразмещения и порождённого
упорядочения справедлива формула $G(\alpha)=G(\beta) + G(\gamma) - H'(\aB)t'(\aB)$.
\end{pro}
\begin{proof}
\begin{enumerate}
	\item Пусть $(x,y)\in E$, $Q/B=(A/B, E', H', t')$. Рассмотрим несколько случаев.
		\begin{enumerate}
			\item$x,y\in B$. Тогда $(x,y)\in E|_B \Rightarrow \beta(x) < \beta(y) 
				\Rightarrow \alpha(x) < \alpha(y)$;
			\item\label{case2}$x\in B, y\not\in B$. Тогда по определению факторразмещения 
				$(\aB,y)~\in~E' \Rightarrow \gamma(\aB) < \gamma(y) \Rightarrow 
				\alpha(y) = \gamma(y) + |B| - 1 > \gamma(\aB) + \beta(x) - 1 = 
				\alpha(x)$, так как $\forall b\in B\ 1 \leq \beta(b) \leq |B|$;
 		 	\item$x\not\in B, y\in B$. Аналогично случаю (\ref{case2}) $(x,\aB)\in
 			 	E' \Rightarrow \gamma(x)~<~\gamma(\aB) \Rightarrow \alpha(x) = \gamma(x)
 	 			< \gamma(\aB) \leq \gamma(\aB) + \beta(b) - 1 = \alpha(b)$;
 	 		\item$x,y\not\in B$. Тогда $(x,y)\in E|_{A\setminus B} \subset E' 
			  \Rightarrow \gamma(x) < \gamma(y)$. Но тогда, как легко видеть, и 
			  $\alpha(x) < \alpha(y)$.
		\end{enumerate}
  \item$G(\alpha) = \sum\limits_{a \in A}H(a)F_\alpha(a)$. Вновь рассмотрим случаи.
  	\begin{enumerate}
  		\item$a\in A\setminus B, \gamma(a) < \gamma(\aB)$. Тогда 
	  		$H(a)F_\alpha(a) = H'(a)F_\gamma$;
	  	\item$a\in B$. Тогда пусть $T = \max\{F_\alpha(a') | a'\in A\setminus B, 
	  		\gamma(a') < \gamma(\aB)\}$. Получим, что $H(a)F_\alpha(a) = H(a)(T 
	  		+ F_\beta(a))$.
	  	\item$a\in A\setminus B, \gamma(a) > \gamma(\aB)$. Тогда вновь из 
	  	определения факторразмещения $H(a)F_\alpha(a) = H'(a)F_\gamma$;
  	\end{enumerate}
  	Подставляя эти выражения в выражение для $G(\alpha)$ получим, что 
  	$G(\alpha)~=~G(\gamma) - H'(\aB)F_\gamma(\aB) + G(\beta) + 
  	T\sum\limits_{b\in B}H(b)$. Но, как легко видеть, $T~=~F_\gamma(\aB) - 
  	t'(\aB)$, поэтому $G(\alpha)=G(\beta) + G(\gamma) - H'(\aB)t'(\aB)$.
\end{enumerate}
\end{proof}
\pagebreak
\section{Основные результаты.}
\begin{teo}
Если в условиях Предложения \ref{inducedCor} упорядочения 
$Q|_B$ и $Q/B$ являются оптимальными, то и порождённое ими упорядочение 
$Q$ будет оптимальным.
\end{teo}
По сути эта теорема и является главным мотивировочным фактором для 
введения большинства понятий предыдущей главы, поскольку фактически 
<<узаконивает>> разбиение исходной задачи об упорядочении на две подзадачи~--- 
об упорядочении подразмещения и факторразмещения.
\begin{proof}
Достаточно показать, что найдётся такое оптимальное упорядочение $Q$, 
которое порождается некоторыми упорядочениями $Q|_B$ и $Q/B$. 
Действительно, пусть $\alpha_0$, $\beta_0,$ и $\gamma_0$~--- оптимальные 
упорядочения $Q$, $Q|_B$ и $Q/B$ соответственно, $\beta_0$ и $\gamma_0$ 
порождают упорядочение $\alpha$, а $\beta$ и $\gamma$~--- упорядочения 
$Q|_B$ и $Q/B$, порождающие $\alpha_0$. Тогда по Предложению~
\ref{inducedCor} $G(\alpha_0)=G(\beta) + G(\gamma) - H'(\aB)t'(\aB) \geq 
G(\beta_0) + G(\gamma_0) - H'(\aB)t'(\aB) = G(\alpha)$, т.\,е. 
$\alpha$~--- также оптимальное.

Рассмотрим теперь два оптимальных размещения $\bar{\beta}$ и $\bar{\alpha}$ 
из определения идеального подразмещения. Пусть $b_0=\min\{\alpha(b) | b\in 
B\}$. Определим $\bar{\gamma}$~--- размещение $Q/B$, следующим образом:
\begin{equation*}
\bar{\gamma}(x) = \begin{cases}
							\alpha(x),       & \alpha(x)<b_0,\\
							b_0,             & x=\aB,\\
							\alpha(x)-|B|+1, & \alpha(x)>b_0+|B|-1.
						\end{cases}
\end{equation*}
Видно, что упорядочения $\bar{\beta}$, $\bar{\gamma}$ порождают 
упорядочение $\bar{\alpha}$.
\end{proof}
Таким образом, исходная задача свелась к задаче о поиске идеальных 
подразмещений, чему и будет посвящена оставшаяся часть главы.

Для удобства дальнейшего изложения введём функцию $P: A \rightarrow \R$, 
$P(a)~=~\frac{H(a)}{t(a)}$ и множество $\tilde{E}=\{(a,b)\in E | P(a) < P(b)\}$.

В \cite{sheduling_theory} показано, что оптимальное упорядочение размещения без условий 
предшествования упорядочивает работы по уменьшению значения функции $P$.
Очевидно, что этот результат будет по-прежнему иметь место, если 
$\tilde{E}~=~\varnothing$.

\begin{lem}\label{localDecrease}
Пусть $\alpha$~--- некоторое оптимальное упорядочение $Q$, $a,b~\in~A$, 
$\alpha(a) + 1 = \alpha(b)$. Тогда $P(a)<P(b)\Rightarrow(a,b)\in E$.
\end{lem}
\begin{proof}
Рассмотрим $\alpha'$~--- упорядочение $A$, полученное из $\alpha$ 
транспозицией элементов $a$ и $b$. Тогда $G(\alpha') = G(\alpha) - 
H(a^*)F_\alpha(a^*) - H(b^*)F\alpha(b^*) + H(a^*)F_{\alpha'}(a^*) + 
H(b^*)F_{\alpha'}(b^*) = G(\alpha) + H(a^*)(F_{\alpha'}(a^*) - 
F_\alpha(a^*)) - H(b^*)(F_\alpha(b^*) - F_{\alpha'}(b^*)) = G(\alpha) + 
H(a^*)t(b^*) - H(b^*)t(a^*) = G(\alpha) + t(a^*)t(b^*)(P(a^*) - P(b^*)) < 
G(\alpha)$. Но $\alpha$~--- оптимальное упорядочение $Q$, следовательно 
$\alpha'$ не может быть упорядочением $Q$. Но такое возможно только в 
случае $(a,b)\in E$.
\end{proof}
Следующая важная теорема показывает, что искомое идеальное подразмещение 
достаточно искать в виде пары работ, наделённой определёнными свойствами.
\begin{teo}
Если для размещении $Q$ $\tilde{E}\not=\varnothing$, то найдётся пара работ 
$(a^*,b^*)\in \tilde{E}$, такая что подразмещение $Q|_{\{a^*,b^*\}}$ будет 
идеальным.
\end{teo}
\begin{proof}
Пусть $\alpha$~--- некоторое оптимальное упорядочение $Q$. Достаточно 
показать, что найдётся пара работ $(a^*,b^*)\in \tilde{E}$, такая что 
$\alpha(a^*)~+~1~=~\alpha(b^*)$.

Пусть $(a,b)\in \tilde{E}$.
Рассмотрим функцию $T: [1,n] \rightarrow \R,\ T(i)=P(\alpha^{-1}(i))$.
Поскольку $T(\alpha(a)) = P(a) < P(b) = T(\alpha(b))$, найдётся $i\in 
[\alpha(a),\alpha(b)-1]: T(i) < T(i+1)$. Пусть $a^*=\alpha^{-1}(i), 
b^*=\alpha^{-1}(i+1)$. Тогда $P(a^*)<P(b^*)$, а следовательно, по лемме \ref{localDecrease}, 
$(a^*,b^*)\in E\Rightarrow (a^*,b^*)\in \tilde{E}$.
\end{proof}
Можно также сформулировать ряд достаточных условий оптимальности 
подразмещения, образованного парой работ.
\begin{teo}\label{sufficient_main}
Пусть пара $(a,b)\in \tilde{E}$ такова, что $\forall e\in A\setminus\{a,b\}\ 
(a,e)~\in~E\Rightarrow (e,b)\notin E$, а для произвольных работ $c,d\in
A$, для которых выполнено $(a,c)\in E, (d,b)\in E$, выполняется хотя бы 
одно из условий: 
\begin{itemize}
	\item $(b,c)\in E$
	\item $(d,a)\in E$
	\item $P(d) > P(c)$.
\end{itemize}
Тогда пара $\{a,b\}$ образует идеальное подразмещение.
\end{teo}
\begin{proof}
Аналогично предыдущей теореме введём упорядочение $\alpha$. 
Пусть $j = \max\{i\in [\alpha(a),\alpha(b)-1] | (a,\alpha^{-1}(i))\in E\}, 
c = \alpha^{-1}(j)$. Пусть также $k = \max\{i\in [j+1,\alpha(b)] | 
(\alpha^{-1}(i),b)\in E\}, d = \alpha^{-1}(k)$. Тогда $P(c) < P(d)$.
Предположим, что $k - i > 1$. Тогда, по замеченному выше, множество 
$B=\alpha^{-1}([j+1,k-1])$ будет идеальным подразмещением. 
Но тогда в факторразмещении $Q/B$ либо $P(c)<P(\aB)$ либо 
$P(\aB)<P(d)$. По лемме \ref{localDecrease} из первого неравенства следует 
существование элемента $c'\in B, (c,c')\in E$, что противоречит выбору 
$j = \alpha(c)$. По той же лемме из второго неравенства следует 
сущестование элемента $d'\in B, (d',d)\in E$, что противоречит выбору 
$k = \alpha(e)$. Таким образом, мы получили, что $k=j+1$. Но тогда, 
вновь по лемме \ref{localDecrease}, $(c,d)\in E\Rightarrow (c,b)\in E
\Rightarrow c=a;(a,d)\in E\Rightarrow d=b$. Получаем, что $\alpha(a)+1 = 
\alpha(b)$, а значит и идеальность порождённого парой $\{a,b\}$ подразмещения.
\end{proof}
Необходимость ограничения $P(d) > P(c)$ показывает следующий
\begin{exa}
Пусть $A=\{1,2,3,4\}, E=\{(1,2),(1,4),(3,4)\}$. Функцию $t$ положим 
постоянной, а функцию $H$ определим следующим образом: $H(1)=11$, $H(2)=19$, 
$H(3)=12$, $H(4)=20$. Тогда $P(1)<P(4)$, $P(2)<P(4)$, $P(1)<P(3)$, но пара 
$\{1,4\}$ не образует идеальное подразмещение.
\end{exa}
В некоторых случаях удобнее пользоваться более простыми критериями, 
которые следуют из вышеприведённой теоремы.
\begin{cons}
Пусть $(a,b)\in \tilde{E}$, $\forall e\in A\setminus\{a,b\}\ (a,e)\in E\Rightarrow 
(e,b)~\notin~E$, $\forall d~\in~A\ (d,b)\in E\Rightarrow (d,a)\in E$. Тогда для 
того, чтобы пара $\{a,b\}$ образовывала идеальное подразмещение, 
достаточно, чтобы для всякого $c\in A, (a,c)~\in~E, c\not=b$ выполнялось 
либо $(b,c)\in E$ либо $P(b)>P(c)$.
\end{cons}
\begin{cons}
Пусть $(a,b)\in \tilde{E}$, $\forall e\in A\setminus\{a,b\}\ (a,e)\in E\Rightarrow 
(e,b)~\notin~E$, $\forall c\in A\ (a,c)\in E\Rightarrow (b,c)\in E$. Тогда для 
того, чтобы пара $\{a,b\}$ образовывала идеальное подразмещение, 
достаточно, чтобы для всякого $d~\in~A, (d,b)~\in~E, d\not=a$ выполнялось 
либо $(d,a)\in E$ либо $P(d)>P(a)$.
\end{cons}

\pagebreak
\section{Алгоритмы.}
Полученные в предыдущей главе результаты позволяют сформулировать два 
алгоритма для решения задачи минимизации суммарной дозы облучения.

В описании алгоритмов предполагается, что задан некоторый набор условий 
предшествования, которые могут не образовывать отношения частичного 
порядка, но не содержат цепочки условий вида $(a_0, a_1)$, $(a_1, 
a_2)$,$\dots$ $(a_{k-1},a_k)$, $(a_k,a_0)$ и, таким образом, задают 
ориентированный бесконтурный граф $G=(A,E), |E|=m$.

Под <<объединением>> двух вершин $i$ и $j$ будем понимать замену их на новую 
вершину $k$, для которой $H_k=H_i+H_j$, $t_k=t_i+t_j$, а дуги выходят 
(входят) из новой вершины в те вершины, в которые выходили (входили) дуги 
из вершин $i$ и $j$.

\begin{algo}
Пусть в графе $G$ нет такой пары вершин $a$ и $b$, что полустепень исхода 
из $a$ больше 1, полустепень входа в $b$ больше 1, и имеется путь из $a$ в 
$b$.

Пусть \strset~--- структура данных, позволяющая извлекать элемент, 
минимальный по некоторому признаку, и объединять две таких структуры. 
Введём также структуру \rootset, состоящую из некоторой вершины графа $r$ и 
некоторого набора вершин, содержащегося в структуре \strset, в 
которой в качестве способа упорядочения выбрано значение функции 
$H_i/t_i$. При формировании структуры \rootset\ из \strset'а вершин 
извлекаются вершины и объединяются с вершиной $r$ (новая вершина заменяет 
вершину $r$) до тех пор, пока значение $H_r/t_r$ не станет меньше 
минимального значения функции $H_i/t_i$ в \strset'е. Для структуры 
\rootset\ можно ввести операцию <<слияния>>, которая объединяет 
вершину $r$ с некоторой вершиной графа, а затем проводит такую же серию 
объединений, как и при формировании. Структуру \rootset\ можно 
также превратить в \strset, добавив вершину $r$ к \strset'у 
вершин.

Любое объединение вершин будем записывать, ассоциируя эту запись с новой 
вершиной.

Будем выполнять алгоритм в несколько шагов.
\begin{enumerate}
  \item Рассмотрим все вершины графа $G$ с полустепенью входа большей 1 и 
	  для каждой из них, если она ещё не была обработана ранее на этом шаге, 
  	выполним следующую процедуру:
		\begin{itemize}
			\item Если полустепень входа текущей вершины равна 0, сформируем 
 				структуру \rootset\ из текущей вершины и пустого 
 				\strset'а и свяжем её с текущей вершиной.
 			\item В противном случае, рассмотрим все вершины, из которых 
 				существует дуга в текущую, выполним для них такую же процедуру.
 				Затем возьмём полученные в результате \rootset'ы,
 				преобразуем их в \strset'ы, объединим, сформируем 
 				\rootset\ из текущей вершины и получившегося 
 				\strset'а вершин и свяжем его с текущей вершиной. Также 
 				удалим все дуги, входящие в текущую вершину.
 		\end{itemize}
		Обработанными будем считать вершины, для которых была выполнена 
		вышеописанная процедура.
	\item Повторим первый шаг, рассматривая вместо вершин с полустепенью 
		входа, большей 1 вершины с полустепенью исхода, большей 1, а 
		вместо вершин с минимальным значением функции $H_i/t_i$~--- вершины с 
		максимальным значением этой функции. При этом, если при некотором 
		объединении одна из объединяемых вершин будет иметь связанный с ней 
		\rootset от первого шага, вместо объединения будем 
		выполнять слияние соответствующего \rootset'а и второй 
		вершины.
	\item Теперь рассмотрим все оставшиеся дуги, будем выбирать те из них, 
		которые идут в направлении возрастания функции $H_i/t_i$ (для того, 
		чтобы исключить лишний перебор, будем использовать очередь). Для 
		каждой такой дуги будем объединять вершины, инцидентные ей, при 
		необходимости выполняя слияния на соответствующих 
		\rootset'ах. Для обоснования корректности использования 
		очереди на этом шаге достаточно заметить, что при объединении пары 
		вершин инцидентные им дуги не могут утратить свойство <<идти в 
		направлении возрастания функции $H_i/t_i$>>.
	\item В полученном графе все дуги будут идти в направлении убывания 
		функции $H_i/t_i$, а значит можно упорядочить все вершины по убыванию 
		этой функции. Для построения ответа сформируем стек из всех вершин 
		графа, имеющихся на этом шаге и упорядоченных по убыванию функции 
		$H_i/t_i$, и будем извлекать по одной вершины из этого стека. Если 
		очередная вершина будет являться вершиной исходного графа, поместим 
		её в итоговое упорядочение, в противном случае возьмём пару вершин, 
		ассоциированную с текущей и поместим их в стек в нужном порядке вместо 
		текущей.
\end{enumerate}
Корректность выполняемых объединений следует из следствий 1 и 2 из теоремы 
\ref{sufficient_main}.

Временная сложность описанного алгоритма зависит от способа реализации 
струкуры \strset. В частности, при использовании для реализации 
декартова дерева (\cite{Cart_tree}), получаем сложность алгоритма $O(n\log n)$.
\end{algo}

В общем случае задача является NP-полной (\cite{Lawler}), но можно 
предложить алгоритм, уменьшающий размер задачи, используя теорему 
\ref{sufficient_main}.
\begin{algo}
Использя алгоритм поиска в глубину (\cite{Cormen}), установим пары вершин, 
между которыми имеется путь в графе $G$. Временая сложность соответствущего 
алгоритма~--- $O(nm)$.

Теперь рассмотрим поочередно все рёбра графа $G$. Пусть $(a,b)$~--- очередное 
ребро, для которого выполнено условие $H_a/t_a<H_b/t_b$. Переберём все 
вершины графа, отличные от $a$ и $b$. Вычислим максимум величины $H_c/t_c$ 
для вершин $c$, для которых в графе $G$ имеется путь из $a$ в $c$, но 
отсутствуют пути из $b$ в $c$ и из $c$ в $b$ (обозначим его за $C$), 
и минимум величины $H_d/t_d$ для вершин $d$, для которых в графе $G$ 
имеется путь из $d$ в $b$, но отсутствуют пути из $d$ в $a$ и из $a$ в $d$ 
(обозначим его за $D$). Если теперь $C < D, C < H(b)/t(b), H(a)/t(a) < D$, 
то пара $(a,b)$ удовлетворяют условиям теоремы \ref{sufficient_main}, и 
эти вершины могут быть объединены. Изменение структуры графа $G$ при 
этом можно осуществить алгоритмом с временной сложностью $O(n)$ (с учётом 
необходимости изменения информации о парах вершин, между которыми имеется 
путь). Таким образом, временная сложность этого шага алгоритма~--- $O(nm)$.

Второй шаг алгоритма можно повторять до тех пор, пока в графе остаются 
пары вершин, к которым можно применить теорему \ref{sufficient_main}, т.\,
е. пока на втором шаге происходит объединение вершин графа. В худшем 
случае временная сложность всего алгоритма составит $O(n^2m)$.
\end{algo}

\pagebreak
\addcontentsline{toc}{section}{Список литературы}
\begin{thebibliography}{0}

\bibitem{tasc_desc}
{\it Балушкин Ф.А., Сесекин А.Н., Ташлыков О.Л., Чеблоков И.Б., Щеклеин 
С.Е., Ченцов А.Г.} Использование метода динамического программирования для 
оптимизации демонтажа оборудования энергоблоков АЭС, выводимых из 
эксплуатации, с целью минимизации облучения // Известия вузов. Ядерная 
энергетика. 2009. №4. С.~3--10.
\bibitem{sheduling_theory}
{\it Конвей Р., Максвелл В., Миллер Л.} Теория Расписаний // 
М.:~Наука. 1975. 360~с.
\bibitem{Cormen}
{\it Кормен Т., Лейзерсон Ч., Ривест Р.} Алгоритмы: построение и анализ. М.: 
МЦНМО: БИНОМ. Лаборатория знаний. 2004. 960~с.
\bibitem{Lawler}
{\it Lawler E.L.} Sequencing jobs to minimize total weighted completion 
time subject to precedence constraints // Annals of Discrete Mathematics 
2. 1978. pp.~75--90.
\bibitem{Cart_tree}
{\it Seidel, Raimund; Aragon, Cecilia R.} Randomized Search Trees //
Algorithmica 16 (4/5). 1996. pp~464--497.
\bibitem{Thesis}
{\it Айзенштейн Д.\,О., Ипатов А.\,В.} Решение задачи минимизации дозы 
облучения персонала методом имитации отжига // Современные проблемы 
математики: тезисы 42-й Всероссийской молодёжной школы-конференции. 
Екатеринбург: Институт математики и механики УрО РАН, 2011. С.~154-156.
\end{thebibliography}
\end{document}