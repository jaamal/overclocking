\colorlet{shaded}{white!60!black}
\newcommand{\slp}[1]{\mathbb{#1}}
\newcommand{\substr}[2]{[#1\dots#2]}

\newcommand{\FibonacciWordSLP}{
    \begin{tikzpicture}
        %draw all letters
        \foreach \x / \letter in {0/a, 0.7/b, 1.4/a, 2.1/a, 2.8/b, 3.5/a, 4.2/b, 4.9/a, 5.6/a, 6.3/b, 7/a, 7.7/a, 8.4/b}
            \draw (\x,0) node[anchor=west] {\scriptsize \emph{\letter}};
            
        %draw all dots between letter
        \foreach \x / \letter in {-0.25, 0.45, 1.15, 1.85, 2.55, 3.25, 3.95, 4.65, 5.35, 6.05, 6.75, 7.45, 8.15, 8.85}
            \draw (\x,0) node[anchor=west] {\scriptsize $\cdot$};   
        
        %draw first level
        \foreach \x in {0.2, 0.9, 1.6, 2.3, 3, 3.7, 4.4, 5.1, 5.8, 6.5, 7.2, 7.9, 8.6}
            \draw[thick] (\x,0.2) -- (\x,0.6);
        
        %draw all terminal rules
        \foreach \x / \number in {0/0, 0.7/1, 1.4/0, 2.1/0, 2.8/1, 3.5/0, 4.2/1, 4.9/0, 5.6/0, 6.3/1, 7/0, 7.7/0, 8.4/1}
            \draw (\x,0.75) node[anchor=west] {\scriptsize $\slp{F}_{\number}$}; 
        
        %draw second level
        \foreach \l in {0.2, 2.3, 3.7, 5.8, 7.9}
            \draw[thick] (\l,1) -- +(0,0.2) -- +(0.35,0.5) -- +(0.7,0.2) -- +(0.7,0);
            
        %draw all third rule
        \foreach \x in {0.4, 2.5, 3.8, 6, 8.1}
            \draw (\x,1.65) node[anchor=west] {\scriptsize $\slp{F}_2$};
            
        %draw third level
        \foreach \x in {0.55, 4.05, 6.15}
            \draw[thick] (\x,1.9) -- +(0.52, 0.4) -- +(1.05, 0) -- +(1.05, -0.9);
        
        %draw fourth fule
        \foreach \x in {0.92, 4.42, 6.52}
            \draw (\x,2.45) node[anchor=west] {\scriptsize $\slp{F}_3$};
        
        \foreach \x in {1.07, 6.67}
            \draw[thick] (\x, 2.65) -- +(0.79, 0.4) -- +(1.58, 0) -- +(1.58, -0.8); 
            
        \foreach \x in {1.71, 7.31}
            \draw (\x, 3.2) node[anchor=west] {\scriptsize $\slp{F}_4$};
            
        \draw[thick] (1.86,3.4) -- +(1.35,0.4) -- +(2.71,0) -- +(2.71,-0.75);
        \draw (3.06, 3.95) node[anchor=west] {\scriptsize $\slp{F}_5$};
        \draw[thick] (3.21,4.15) -- +(2.12,0.6) -- +(4.25,0) -- +(4.25,-0.75);
        \draw (5.18,4.9) node[anchor=west] {\scriptsize $\slp{F}_6$};
    \end{tikzpicture}
}

\newcommand{\palindromesLocation}{
    \begin{tikzpicture}
        \draw[thick] (0, 0) rectangle (10, 1);
        \draw[thick] (5, -0.2) -- (5, 1.2);
    
        \draw<1, 3-5> (2.4, 0.3) node[anchor=west] {$S_\ell$};
        \draw<1-2, 4-5> (7.4, 0.3) node[anchor=west] {$S_r$};
        \draw (4.7, -0.6) node[anchor=west] {$|S_\ell|$};
        
        \draw<2> (1.2, 0.3) node[anchor=west] {\emph{ababa}};
        \draw<3> (6.2, 0.3) node[anchor=west] {\emph{ababa}};
        \draw<4-> (4.2, 0.3) node[anchor=west] {\emph{aba}};
        \draw<4-> (4.95, 0.3) node[anchor=west] {\emph{ba}};
    \end{tikzpicture}
}

\newcommand{\squaresDetecting}{
    \begin{tikzpicture}
        \draw[thick] (0, 0) rectangle (5, 0.7);
        \draw[thick] (2.5, 0) -- (2.5, 0.7);
    
        \draw (0, 0.7) .. controls (0.75, 1.3) and (1.75, 1.3) .. (2.5, 0.7);
        \draw (2.5, 0.7) .. controls (3.25, 1.3) and (4.25, 1.3) .. (5, 0.7);
        
        \draw (1.1, 1.4) node[anchor=west] {\emph{X}};
        \draw (3.6, 1.4) node[anchor=west] {\emph{X}};
        
        \draw<2->[very thick] (1, 0) rectangle (2,0.7);
        \draw<2-> (1.3, 0.35) node[anchor=west] {\emph{B}};
        
        \draw<3->[very thick] (3.5,0) rectangle (4.5, 0.7);
        \draw<3-> (3.8, 0.35) node[anchor=west] {\emph{B}};
        
        \draw<4->[thick, <->] (2, -0.6) -- (4.5, -0.6);
        \draw<4->[thick] (2, -0.5) -- (2, -0.7);
        \draw<4->[thick] (4.5, -0.5) -- (4.5, -0.7);
        \draw<4-> (3, -0.35) node[anchor=west] {$|X|$};
    \end{tikzpicture}
}

\newcommand{\squaresAlgorithm}{
    \begin{tikzpicture}
        \draw[thick] (0, 0) rectangle (11.2, 0.7);
        \draw[thick] (5.6, -0.2) -- (5.6, 0.9);
        \draw (5.2, -0.5) node[anchor=west] {$|S_\ell|$};
        
        \draw<1-2> (2.5, 0.3) node[anchor=west] {$S_\ell$};
        \draw<1-2> (8.1, 0.3) node[anchor=west] {$S_r$};
        
        \draw<2-> (0, -2) node[anchor=west] {\mbox{Let |S_i| = 2^n. Lengths\ of\ roots: $\{1\}, \{2\}, \{3, 4\}, \dots, \{2^{n-2} + 1, \dots, 2^{n-1}\}.$}};
        
        \draw<3-> (0.7, 0)  -- (0.7, 0.7); \draw<3-> (1.4, 0)  -- (1.4, 0.7); \draw<3-> (2.1, 0)  -- (2.1, 0.7); \draw<3> (2.8, 0)  -- (2.8, 0.7);
        \draw<3-> (3.5, 0)  -- (3.5, 0.7); \draw<3-> (4.2, 0)  -- (4.2, 0.7); \draw<3-> (4.9, 0)  -- (4.9, 0.7); 
        \draw<3-> (6.3, 0)  -- (6.3, 0.7); \draw<3-> (7, 0)  -- (7, 0.7); \draw<3-> (7.7, 0)  -- (7.7, 0.7); \draw<3> (8.4, 0)  -- (8.4, 0.7);
        \draw<3-> (9.1, 0)  -- (9.1, 0.7); \draw<3-> (9.8, 0)  -- (9.8, 0.7); \draw<3-> (10.5, 0)  -- (10.5, 0.7); 
        \draw<3-> (0.2, 0.3) node[anchor=west] {1}; \draw<3-> (0.85, 0.3) node[anchor=west] {2}; \draw<3-> (1.55, 0.3) node[anchor=west] {3};
        \draw<3-> (2.25, 0.3) node[anchor=west] {4}; \draw<3-7> (2.95, 0.3) node[anchor=west] {5}; \draw<3-> (3.65, 0.3) node[anchor=west] {6};
        \draw<3-7> (4.35, 0.3) node[anchor=west] {7}; \draw<3-5> (5, 0.3) node[anchor=west] {8}; \draw<3-5> (5.75, 0.3) node[anchor=west] {9};
        \draw<3-7> (6.3, 0.3) node[anchor=west] {10}; \draw<3-> (7.05, 0.3) node[anchor=west] {11}; \draw<3-> (7.7, 0.3) node[anchor=west] {12};
        \draw<3-> (8.4, 0.3) node[anchor=west] {13}; \draw<3-> (9.1, 0.3) node[anchor=west] {14}; \draw<3-> (9.8, 0.3) node[anchor=west] {15};
        \draw<3-> (10.5, 0.3) node[anchor=west] {16};
        
        \draw<3-> (0, -2.6) node[anchor=west] {\mbox{Let length of a block B be equal to $2^{n-3}$. }};
        
        \draw<4->[very thick] (2.8, -0.2) -- (2.8, 0.9);
        \draw<4->[very thick] (2.8, -0.18) -- (2.9, -0.18);
        \draw<4->[very thick] (2.8, 0.88) -- (2.9, 0.88);
        \draw<4->[very thick] (8.4, -0.2) -- (8.4, 0.9);
        \draw<4->[very thick] (8.4, -0.18) -- (8.3, -0.18);
        \draw<4->[very thick] (8.4, 0.88) -- (8.3, 0.88);
        
        \filldraw<5->[color=shaded] (3.52, 0.02) rectangle (4.18, 0.69);
        \draw<5-> (3.6, 0.3) node[anchor=west] {$B$};
        
        \draw<6>[very thick] (4.9, 0) rectangle (6.3, 0.7);
        
        \filldraw<7->[color=shaded] (5.52, 0.02) rectangle (6.18, 0.69);
        \draw<7-> (5.6, 0.3) node[anchor=west] {$B$};
        
        \draw<8->[->,thick] (4.2, 0.35) -- (5,0.35);
        \draw<8->[->,thick] (6.2,0.35) -- (7,0.35);
        \draw<8->[->,thick] (3.5,0.35) -- (3,0.35);
        \draw<8->[->,thick] (5.5,0.35) -- (5,0.35);
        
        \draw<9>[thick] (3,0.7) .. controls (3.75,1.1) and (4.25,1.1) .. (5,0.7);
        \draw<9>[thick] (5,0.7) .. controls (5.75,1.1) and (6.25,1.1) .. (7,0.7);
    \end{tikzpicture}
}

\newcommand{\collectingTool}{
    \begin{tikzpicture}
        \draw (1.8, 0.1) node[anchor=west] {$\slp{S}_i$};
        \draw (-0.3, -1.15) node[anchor=west] {$\slp{S}_\ell$};
        \draw (3.7, -1.2) node[anchor=west] {$\slp{S}_r$};
        
        \draw[thick] (1.9,-0.1) -- (0.1, -0.9);
        \draw[thick] (2.1,-0.1) -- (3.9, -0.9);
        \draw[thick] (-1.5, -2.2) -- (-0.2, -1.3);
        \draw[thick] (1.9, -2.2) -- (0, -1.3);
        \draw[thick] (2.1, -2.2) -- (3.7, -1.3);
        \draw[thick] (5, -2.2) -- (4, -1.3);
        
        \draw[thick] (-1.5, -2.5) rectangle (1.9, -2.2);
        \draw[thick] (2.1, -2.5) rectangle (5, -2.2);
    \end{tikzpicture}
}
